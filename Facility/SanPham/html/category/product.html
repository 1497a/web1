<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../../SanPham/fontawesome-free-6.2.0-web/css/all.css">
    <link rel="stylesheet" href="../../../SanPham/bootstrap-5.2.2-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../../SanPham/font_Roboto/Roboto-Bold.ttf">
    <link rel="stylesheet" href="../../../css/themify-icons/themify-icons.css">
    <link rel="stylesheet" href="../../../SanPham/css/product.css">
    <script src="../../..//SanPham/js/jquery.min.js"></script>
    <link rel="stylesheet" href="../../../css/style.css">
    <script src="../../../bootstrap-5.0.2-dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../../style.js"></script>
    <link rel="stylesheet" href="../../../css/cart.css">
    <title>Sản phẩm</title>
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
            <div class="container">
                <a class="navbar-brand" href="../../../Index.html">
                    <img src="../../../SanPham/img/logo.png">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0" style="width: 28em">
                        <li class="nav-item">
                            <a class="nav-link " href="../../../Index.html">Trang chủ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="../../../header/GioiThieu.html">Giới thiệu</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="../../../SanPham/html/category/product.html"
                                id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                                Sản Phẩm
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <li><a class="dropdown-item" href="javascript:void(0)"
                                        onclick='updateUrl(["Tất cả sản phẩm"], [])'>Tất cả sản phẩm</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="javascript:void(0)"
                                        onclick='updateUrl(["Bàn gỗ"], [])'>Bàn Gỗ</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="javascript:void(0)"
                                        onclick="updateUrl(['Kệ sách'], [])">Kệ Sách</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="javascript:void(0)"
                                        onclick="updateUrl(['Rèm cửa'], [])">Rèm Cửa</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="javascript:void(0)"
                                        onclick="updateUrl(['Ghế sofa'], [])">Ghế Sofa</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="javascript:void(0)"
                                        onclick="updateUrl(['Tủ quần áo'], [])">Tủ Quần Áo</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="javascript:void(0)"
                                        onclick="updateUrl(['Giường ngủ'], [])">Giường Ngủ</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="javascript:void(0)"
                                        onclick="updateUrl(['Phòng tắm'], [])">Phòng Tắm</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="javascript:void(0)"
                                        onclick="updateUrl(['Đèn trang trí'], [])">Đèn trang trí</a></li>
                            </ul>

                        </li>

                        <li class="nav-item">
                            <a class="nav-link " href="../../../header/TinTuc.html">Tin tức</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="../../../header/LienHe.html">Liên Hệ</a>
                        </li>
                    </ul>
                    <form id="searchForm" class="d-flex display: block">
                        <input class="search-input" type="text" placeholder="Tìm" aria-label="Search" id="myInput"
                            onkeyup="myFunction()">
                        <button onclick="redirectToProductPage()" class="btn btn-primary search-btn" type="button"><span
                                class="ti-search"></span></button>
                    </form>
                    <div class="icon-user">
                        <li class="nav-item dropdown">
                            <a class="fas fa-user nav-link dropdown-toggle" id="navbarDropdown" role="button"
                                data-bs-toggle="dropdown"></a>
                            <ul class="dropdown-menu">
                                <li>
                                    <a href="../../../SanPham/html/Dangnhap.html" class="dropdown-item">
                                        Đăng Nhập</a>
                                </li>
                                <li class="dropdown-divider"></li>
                                <li>
                                    <a href="../../../SanPham/html/Dangky.html" class="dropdown-item">
                                        Đăng Ký
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </div>
                    <a href="../../../SanPham/html/cart.html" title="Mua hàng" class="cart">
                        <li class="fas fa-cart-shopping"><span>0</span></li>
                    </a>
                </div>
            </div>
            </div>
        </nav>
    </header>

    <section class="category">
        <div class="top_nav">
            <ul class="line_up">
                <li><a href="/Index.html">Trang chủ</a></li>
                <li><i class="fas fa-chevron-right"></i></li>
                <li id="name-category"></li>
            </ul>
            <hr>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-lg-3 category_left">
                    <div class="row">
                        <div class="col-lg-12 category_top">
                            <div class="title_module_main">
                                <h2>DANH MỤC SẢN PHẨM</h2>
                            </div>
                        </div>

                        <div class="category_left_content">
                            <ul>
                                <li class="category_left_menu"><i class="fas fa-chevron-right"></i><a
                                        style="cursor: pointer;">LOẠI SẢN PHẨM</a>
                                    <ul>
                                        <li><input name="category" type="checkbox" value="all"
                                                onclick="filterProducts()"> Tất cả Sản Phẩm</li>
                                        <li><input name="category" type="checkbox" value="Bàn gỗ"
                                                onclick="filterProducts()"> Bàn gỗ</li>
                                        <li><input name="category" type="checkbox" value="Kệ sách"
                                                onclick="filterProducts()"> Kệ sách</li>
                                        <li><input name="category" type="checkbox" value="Rèm cửa"
                                                onclick="filterProducts()"> Rèm cửa</li>
                                        <li><input name="category" type="checkbox" value="Ghế sofa"
                                                onclick="filterProducts()"> Ghế sofa</li>
                                        <li><input name="category" type="checkbox" value="Phòng tắm"
                                                onclick="filterProducts()"> Phòng tắm</li>
                                        <li><input name="category" type="checkbox" value="Tủ quần áo"
                                                onclick="filterProducts()"> Tủ quần áo</li>
                                        <li><input name="category" type="checkbox" value="Giường ngủ"
                                                onclick="filterProducts()"> Giường ngủ</li>
                                        <li><input name="category" type="checkbox" value="Đèn trang trí"
                                                onclick="filterProducts()"> Đèn trang trí</li>
                                    </ul>
                                </li>
                            </ul>
                            <ul>
                                <li class="category_left_menu">
                                    <i class="fas fa-chevron-right"></i>
                                    <a style="cursor: pointer;">THƯƠNG HIỆU</a>
                                    <ul>
                                        <li><input name="brand" type="checkbox" id="kenny" value="Kenny Furniture"
                                                onclick="filterProducts()"> Kenny Furniture</li>
                                        <li><input name="brand" type="checkbox" id="first_impression"
                                                value="First Impression" onclick="filterProducts()"> First Impression
                                        </li>
                                        <li><input name="brand" type="checkbox" id="big_one" value="Big One"
                                                onclick="filterProducts()"> Big One</li>
                                        <li><input name="brand" type="checkbox" id="furniland" value="Furniland"
                                                onclick="filterProducts()"> Furniland</li>
                                        <li><input name="brand" type="checkbox" id="my_home" value="My home"
                                                onclick="filterProducts()"> My home</li>
                                    </ul>
                                </li>

                            </ul>
                            <ul>
                                <li class="category_left_menu">
                                    <i class="fas fa-chevron-right"></i>
                                    <a style="cursor: pointer;">GIÁ</a>
                                    <ul>
                                        <li><input name="price" type="checkbox" value="0-500000"
                                                onclick="filterProducts()"> Dưới 500,000 VNĐ</li>
                                        <li><input name="price" type="checkbox" value="500000-1000000"
                                                onclick="filterProducts()"> 500,000 - 1,000,000 VNĐ</li>
                                        <li><input name="price" type="checkbox" value="1000000-3000000"
                                                onclick="filterProducts()"> 1,000,000 - 3,000,000 VNĐ</li>
                                        <li><input name="price" type="checkbox" value="3000000-5000000"
                                                onclick="filterProducts()"> 3,000,000 - 5,000,000 VNĐ</li>
                                        <li><input name="price" type="checkbox" value="5000000-"
                                                onclick="filterProducts()"> Trên 5,000,000 VNĐ</li>
                                    </ul>
                                </li>
                            </ul>


                            <script>
                                // const itemsliderbar = document.querySelectorAll(".category_left_menu")
                                // itemsliderbar.forEach(function(menu, index) {
                                //     menu.addEventListener("click", function() {
                                //         menu.classList.toggle("block")
                                //     })
                                // })
                            </script>
                        </div>

                        <div class="col-lg-12 category_top">
                            <div class="title_module_main">
                                <h2>SẢN PHẨM BÁN CHẠY</h2>
                            </div>
                            <div class="category_hot_item col-12" id="hot-product">

                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-9 category_right">
                    <div class="row category_top">
                        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                            <div class="category_title col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                <div class="title_module_main">
                                    <h2>DANH SÁCH SẢN PHẨM</h2>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-4 col-sm-8 col-md-8 col-lg-8">
                            <div class="row">
                                <div class="dropdown category_right_top col-xs-12 col-sm-12 col-md-6 col-lg-6">

                                </div>
                                <div class="category_right_top col-xs-12 col-sm-12 col-md-6 col-lg-6">
                                    <select id="arrange" onchange="arrangeAndFilterProducts()">
                                        <option value="default">Sắp xếp</option>
                                        <option value="az">A -> Z</option>
                                        <option value="za">Z -> A</option>
                                        <option value="priceDesc">Giá giảm dần</option>
                                        <option value="priceAsc">Giá tăng dần</option>
                                    </select>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="category_right_content row" id="product">

                    </div>

                    <div class="category_paging">
                        <ul class="pagination">
                            <li class="page-item page_btn_prev"><a class="page-link"><i
                                        class="fas fa-chevron-left"></i></a></li>
                            <div class="pagination number_page" id="number_page">

                            </div>
                            <li class="page-item page_btn_next"><a class="page-link"><i
                                        class="fas fa-chevron-right"></i></a></li>
                        </ul>
                    </div>

                </div>

            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-12 col-md-12 col-lg-3 intro">
                    <h4>GIỚI THIỆU</h4>
                    <p>Đến với Dekor, bạn hoàn toàn yên tâm để chọn được cho mình một bộ nội thất phù hợp nhất, kết hợp
                        đầy đủ, hài hòa các yếu tố về màu sắc, kiểu dáng, kích thước để làm cho không gian ngôi nhà bạn
                        trở nên ấn tượng hơn!</p>
                    <ul>
                        <li><a href=""><i class="ti-facebook"></i></a></li>
                        <li><a href=""><i class="ti-twitter"></i></a></li>
                        <li><a href=""><i class="ti-email"></i></a></li>
                        <li><a href=""><i class="ti-youtube"></i></a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-md-6 col-lg-3 policy news">
                    <h4>CHÍNH SÁCH</h4>
                    <div class="news_item row"
                        style="display: inline-block; margin-right: 10px; position: relative; padding-left: 20px;">
                        <span>●</span>
                        Chính sách bảo hành
                    </div>
                    <div class="news_item row"
                        style="display: inline-block; margin-right: 10px; position: relative; padding-left: 20px;">
                        <span>●</span>
                        Chính sách bảo mật
                    </div>
                    <div class="news_item row"
                        style="display: inline-block; margin-right: 10px; position: relative; padding-left: 20px;">
                        <span>●</span>
                        Chính sách đổi trả
                    </div>
                    <div class="news_item row"
                        style="display: inline-block; margin-right: 10px; position: relative; padding-left: 20px;">
                        <span>●</span>
                        Chính sách giao hàng
                    </div>
                    <div class="news_item row"
                        style="display: inline-block; margin-right: 10px; position: relative; padding-left: 20px;">
                        <span>●</span>
                        Chính sách thanh toán
                    </div>
                </div>


                <div class="col-xs-12 col-md-6 col-lg-3 addr">
                    <h4>ĐỊA CHỈ LIÊN HỆ</h4>
                    <p><i class="fas fa-location-dot"></i>Đường Số 1, Quận 1, TP. Hồ Chí Minh, Việt Nam</p>
                    <p class="phone_num"><i class="fas fa-phone"></i><a href="">+84 123 456 789</a></p>
                    <p>
                    <form class="form">
                        <input type="email" class="form__field" placeholder="Đăng Ký Subscribe Email" />
                        <button type="button" class="asd btn btn-primary ">Gửi</button>
                    </form>
                    </p>
                </div>
                <div class="col-xs-12 col-md-6 col-lg-3 news">
                    <h4>TIN MỚI</h4>
                    <div class="news_item row">
                        <div class="col-2 news_img">
                            <img src="../../../SanPham/img/news/news_1.png">
                        </div>
                        <div class="col-9 news_info">
                            <h5><a href="../../../header/TinTuc1.html">Bí quyết bảo quản nội thất gỗ</a></h5>
                            <p>11/11/2022</p>
                        </div>
                    </div>
                    <div class="news_item row">
                        <div class="col-2 news_img">
                            <img src="../../../SanPham/img/news/news_2.png">
                        </div>
                        <div class="col-9 news_info">
                            <h5><a href="../../../header/Tintuc2.html">Kinh nghiệm mua, bảo quản nội thất</a></h5>
                            <p>11/11/2022</p>
                        </div>
                    </div>
                    <div class="news_item row">
                        <div class="col-2 news_img">
                            <img src="../../../SanPham/img/news/news_3.png" alt="">
                        </div>
                        <div class="col-9 news_info">
                            <h5><a href="../../../header/Tintuc3.html">Bố trí nội thất, cần tránh những gì ?</a></h5>
                            <p>11/11/2022</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="../../../SanPham/js/data.js"></script>
    <script src="../../../SanPham/js/icon_cart.js"></script>
    <script src="../../../SanPham/js/account.js"></script>
    <script src="../../../SanPham/js/pagination.js"></script>
    <script src="../../../SanPham/js/product.js"></script>
    <script>
        function updateUrl(categories, brands) {
            // Mã hóa categories và brands thành chuỗi JSON và sau đó mã hóa URL
            const encodedCategories = (JSON.stringify(categories));
            const encodedBrands = (JSON.stringify(brands));

            // Cập nhật URL với các tham số mới
            const url = new URL(getBasePath() + '/SanPham/html/category/product.html'); // Chuyển hướng đến trang sản phẩm
            url.searchParams.set('categories', encodedCategories);
            url.searchParams.set('brands', encodedBrands);

            // Chuyển hướng đến URL mới
            window.location.href = url.toString();
        }

        // Hàm để lấy danh sách sản phẩm bán chạy
        function renderTopSellingProducts() {
            // Lấy danh sách orders từ localStorage
            const orders = JSON.parse(localStorage.getItem('orders')) || [];

            // Tạo đối tượng đếm số lượng bán ra của từng sản phẩm
            const productCounts = {};
            orders.forEach(order => {
                order.products.forEach(product => {
                    if (!productCounts[product.id]) {
                        productCounts[product.id] = { ...product, count: 0 };
                    }
                    productCounts[product.id].count += product.quantity;
                });
            });

            // Chuyển đổi đối tượng thành mảng và sắp xếp giảm dần theo số lượng
            const sortedProducts = Object.values(productCounts).sort((a, b) => b.count - a.count);

            // Lấy 5 sản phẩm bán chạy nhất
            const topProducts = sortedProducts.slice(0, 5);

            // Render ra HTML
            const hotProductContainer = document.getElementById('hot-product');
            hotProductContainer.innerHTML = '';

            topProducts.forEach(product => {
                const productHTML = `
            <div class="hot_item row">
                <div class="col-4">
                    <img src="${getBasePath() + product.image}" alt="${product.title}">
                </div>
                <div class="col-8">
                    <h5><a href="${getBasePath()}/SanPham/html/category/detail_item/product_detail.html?id=${product.id}">${product.title}</a></h5>
                    <p>${product.price.toLocaleString()}<u>đ</u></p>
                </div>
            </div>
        `;
                hotProductContainer.insertAdjacentHTML('beforeend', productHTML);
            });
        }

        // Gọi hàm khi trang được load
        document.addEventListener('DOMContentLoaded', renderTopSellingProducts);

    </script>
</body>

</html>